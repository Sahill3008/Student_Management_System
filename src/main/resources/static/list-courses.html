<!DOCTYPE html>
<html>
<head>
    <title>Course List</title>
    <link href="/css/style.css" rel="stylesheet">
    <style>
        .course-box {
            padding: 15px;
            margin: 15px;
            border: 1px solid #ccc;
            border-radius: 8px;
        }

        .students-list {
            margin-left: 20px;
        }
    </style>
</head>
<body>

<h2>List of Courses</h2>

<button onclick="loadCourses()">Load Courses</button>

<div id="courseContainer"></div>

<script>
    async function loadCourses() {
        const res = await fetch("/courses");
        const courses = await res.json();
        const container = document.getElementById("courseContainer");
        container.innerHTML = "";

        for (const c of courses) {

            // Create course box
            const div = document.createElement("div");
            div.className = "course-box";

            div.innerHTML = `
            <h3>${c.courseName}</h3>
            <p>${c.description}</p>
            <strong>Students Enrolled:</strong>
            <ul id="students-${c.id}" class="students-list"></ul>
        `;

            container.appendChild(div);

            // Load students for this course
            loadStudentsForCourse(c.id);
        }
    }

    // Fetch students assigned to a specific course
    async function loadStudentsForCourse(courseId) {
        const res = await fetch("/students");
        const data = await res.json();
        const listElement = document.getElementById("students-" + courseId);

        data.content.forEach(s => {
            if (s.courseIds.includes(courseId)) {
                const li = document.createElement("li");
                li.textContent = s.name + " (" + s.email + ")";
                listElement.appendChild(li);
            }
        });
    }
</script>

</body>
</html>
