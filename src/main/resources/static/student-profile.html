<!DOCTYPE html>
<html>
<head>
    <title>Student Profile</title>
    <link href="/css/style.css" rel="stylesheet">
</head>
<body>

<h1>Student Profile</h1>

<div id="profile"></div>

<script>
    // Get student id from URL
    const params = new URLSearchParams(window.location.search);
    const studentId = params.get("studentId");

    // Fetch student
    fetch(`/students/${studentId}`)
        .then(res => res.json())
        .then(s => {
            let html = `
            <h2>${s.name}</h2>
            <p><strong>Email:</strong> ${s.email}</p>
            <p><strong>Age:</strong> ${s.age}</p>
        `;

            // Department
            if (s.department) {
                html += `
                <h3>Department</h3>
                <p>${s.department.deptName}</p>
            `;
            } else {
                html += "<p>No department assigned.</p>";
            }

            // Profile
            if (s.profile) {
                html += `
                <h3>Profile</h3>
                <p><strong>Bio:</strong> ${s.profile.bio}</p>
                <p><strong>Address:</strong>
                    ${s.profile.address.street},
                    ${s.profile.address.city},
                    ${s.profile.address.state} -
                    ${s.profile.address.zip}
                </p>
            `;
            } else {
                html += "<p>No profile added.</p>";
            }

            // Courses
            html += "<h3>Enrolled Courses</h3>";
            if (s.courses && s.courses.length > 0) {
                s.courses.forEach(c => {
                    html += `<p>${c.courseName}</p>`;
                });
            } else {
                html += "<p>No courses assigned.</p>";
            }

            document.getElementById("profile").innerHTML = html;
        })
        .catch(err => {
            document.getElementById("profile").innerHTML = "Error fetching student.";
        });
</script>

</body>
</html>
