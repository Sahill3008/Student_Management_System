<!DOCTYPE html>
<html>
<head>
    <title>List Students</title>
    <link href="/css/style.css" rel="stylesheet">
</head>
<body>

<h1>Students</h1>

<table>
    <thead>
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Email</th>
        <th>Age</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody id="studentTable"></tbody>
</table>

<script>
    // Fetch students
    function loadStudents() {
        fetch("/students")
            .then(res => res.json())
            .then(data => {
                let rows = "";
                data.content.forEach(s => {
                    rows += `
                    <tr>
                        <td>${s.id}</td>
                        <td>${s.name}</td>
                        <td>${s.email}</td>
                        <td>${s.age}</td>
                        <td>
                            <button onclick="deleteStudent(${s.id})">Delete</button>
                            <button onclick="assignCourse(${s.id})">Assign Course</button>
                            <button onclick="viewProfile(${s.id})">Profile</button>
                        </td>
                    </tr>
                `;
                });
                document.getElementById("studentTable").innerHTML = rows;
            });
    }

    // Delete student
    function deleteStudent(id) {
        if (!confirm("Are you sure?")) return;

        fetch(`/students/${id}`, {
            method: "DELETE"
        })
            .then(() => {
                alert("Student deleted");
                loadStudents();
            });
    }

    // Assign course
    function assignCourse(id) {
        window.location.href = `/assign-course.html?studentId=${id}`;
    }

    // View Profile
    function viewProfile(id) {
        window.location.href = `/student-profile.html?studentId=${id}`;
    }

    loadStudents();
</script>

</body>
</html>
