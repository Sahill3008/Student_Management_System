<!DOCTYPE html>
<html>
<head>
    <title>Update Course</title>
    <link href="/css/style.css" rel="stylesheet">
</head>
<body>

<h2>Update Course</h2>

<select id="courseSelect" onchange="loadDetails()"></select>

<input id="courseName" placeholder="New Name"><br>
<input id="description" placeholder="New Description"><br>

<button onclick="updateCourse()">Update</button>

<script>
    async function loadList() {
        const res = await fetch("/courses");
        const data = await res.json();

        const select = document.getElementById("courseSelect");
        data.forEach(c => {
            let opt = document.createElement("option");
            opt.value = c.id;
            opt.text = c.courseName;
            select.add(opt);
        });
    }

    async function loadDetails() {
        const id = document.getElementById("courseSelect").value;
        if (!id) return;

        const res = await fetch(`/courses/${id}`);
        const c = await res.json();

        document.getElementById("courseName").value = c.courseName;
        document.getElementById("description").value = c.description;
    }

    async function updateCourse() {
        const id = document.getElementById("courseSelect").value;

        const body = {
            courseName: document.getElementById("courseName").value,
            description: document.getElementById("description").value
        };

        const res = await fetch(`/courses/${id}`, {
            method: "PUT",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify(body)
        });

        if (res.ok) alert("Updated!");
        else alert("Update failed");
    }

    loadList();
</script>

</body>
</html>
